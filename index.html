<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• v32 (Fix Layout)</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a9f56;
            --primary-dark: #137a41;
            --shift-m: #d1f7d6; 
            --shift-a: #fff3cd;
            --shift-n: #e2d9f3;
            /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏∂‡∏á‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô */
            --w-no: 40px;
            --w-name: 200px;
            --w-pos: 80px;
            /* ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞ Left ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ */
            --l-name: var(--w-no); /* ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å No */
            --l-pos: calc(var(--w-no) + var(--w-name)); /* ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å Name */
        }

        body {
            font-family: 'Sarabun', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
            font-size: 14px;
        }

        /* --- Header --- */
        .navbar {
            background-color: var(--primary);
            color: white;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-left { display: flex; align-items: center; gap: 15px; }
        .nav-title { font-size: 1.2rem; font-weight: bold; }
        .version-badge { background: #ffc107; color: #000; padding: 2px 8px; border-radius: 12px; font-size: 0.8rem; }
        
        .nav-controls {
            background: rgba(0,0,0,0.1);
            padding: 5px 10px;
            border-radius: 5px;
            display: flex; gap: 5px; align-items: center;
        }
        
        button {
            border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;
            font-family: 'Sarabun'; font-weight: 600; transition: 0.2s;
        }
        .btn-stat { background: #4285f4; color: white; }
        .btn-auto { background: #ffc107; color: #000; }
        .btn-clear { background: #dc3545; color: white; }
        .btn-add { background: #0d6efd; color: white; }
        .btn-export { background: #fff; color: var(--primary); border: 1px solid var(--primary); }

        /* --- Note Area --- */
        .note-section { padding: 10px 20px; background: #eefbf3; border-bottom: 1px solid #ddd; }
        .note-input { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px; font-family: 'Sarabun'; }

        /* --- Main Table Container --- */
        .table-container {
            overflow: auto; /* Scroll ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏Å‡∏ô X ‡πÅ‡∏•‡∏∞ Y */
            height: calc(100vh - 140px); /* ‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠‡∏û‡∏≠‡∏î‡∏µ */
            background: white;
            position: relative;
        }

        table {
            border-collapse: separate; /* ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ separate ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ sticky ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Å‡∏±‡∏ö border */
            border-spacing: 0;
            min-width: 100%;
        }

        th, td {
            border-right: 1px solid #ccc;
            border-bottom: 1px solid #ccc;
            text-align: center;
            padding: 4px;
            font-size: 13px;
            height: 24px;
            box-sizing: border-box; /* ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏£‡∏ß‡∏° padding ‡πÉ‡∏ô width */
        }

        /* --- Sticky Columns Logic (‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤) --- */
        .sticky-col {
            position: sticky;
            z-index: 20; /* ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ */
            background-color: #fff;
            /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏≠‡∏¢ */
            box-shadow: 2px 0 5px -2px rgba(0,0,0,0.1); 
        }

        /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô */
        .col-no {
            left: 0;
            width: var(--w-no);
            min-width: var(--w-no);
            max-width: var(--w-no);
            border-left: 1px solid #ccc;
        }
        .col-name {
            left: var(--l-name);
            width: var(--w-name);
            min-width: var(--w-name);
            max-width: var(--w-name);
            text-align: left;
            padding-left: 10px;
        }
        .col-pos {
            left: var(--l-pos);
            width: var(--w-pos);
            min-width: var(--w-pos);
            max-width: var(--w-pos);
            border-right: 2px solid #aaa !important; /* ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á */
        }

        /* Header Specifics */
        thead th {
            position: sticky;
            top: 0;
            z-index: 10; /* Header ‡∏õ‡∏Å‡∏ï‡∏¥ */
            background-color: #f1f3f4;
            height: 40px;
            border-top: 1px solid #ccc;
        }
        
        /* Sticky Header (‡∏°‡∏∏‡∏°‡∏ã‡πâ‡∏≤‡∏¢‡∏ö‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏™‡∏∏‡∏î) */
        thead th.sticky-col {
            z-index: 30; /* ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: ‡∏ó‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á Header ‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÅ‡∏•‡∏∞ Col ‡∏ã‡πâ‡∏≤‡∏¢ */
            background-color: #e8eaed;
        }

        .day-header { cursor: pointer; min-width: 30px; }
        .day-header.weekend { background-color: #ffdede; color: #d60000; }
        .day-header.holiday { background-color: #ffcccc; border: 2px solid red; }

        /* Rows Types */
        .row-ot td { background-color: #fcfcfc; }
        .row-reg td { background-color: #fff; }

        /* Interactive Cells */
        .shift-cell { cursor: pointer; user-select: none; }
        .shift-cell:hover { background-color: #eee; }

        .s-m { background-color: var(--shift-m); color: green; font-weight: bold; }
        .s-a { background-color: var(--shift-a); color: #d48806; font-weight: bold; }
        .s-n { background-color: var(--shift-n); color: purple; font-weight: bold; }
        .s-off { color: #ccc; }
        .s-va { background-color: #cce5ff; color: blue; }
        .error-shift { border: 2px solid red !important; background-color: #ffdddd !important; }

        /* Footer */
        tfoot td {
            position: sticky;
            bottom: 0;
            background-color: #fff;
            z-index: 10;
            font-weight: bold;
            border-top: 2px solid #aaa;
        }
        tfoot td.sticky-col { z-index: 30; background-color: #f8f9fa; border-top: 2px solid #aaa; }

        /* Edit Icon */
        .edit-icon { opacity: 0.3; cursor: pointer; float: right; margin-right: 5px; }
        .sticky-col:hover .edit-icon { opacity: 1; }
        
        .ft-m { color: green; background: #e6fffa; }
        .ft-a { color: #d48806; background: #fffbe6; }
        .ft-n { color: purple; background: #f9f0ff; }
        
        .count-err { color: red; font-weight: bold; }
        .count-ok { color: green; }

    </style>
</head>
<body>

    <div class="navbar">
        <div class="nav-left">
            <div class="nav-title">üìÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡πÄ‡∏ß‡∏£ (Fix Layout) <span class="version-badge">v32</span></div>
            <div style="font-size: 0.9rem;">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° 2568</div>
        </div>
        <div class="nav-right">
            <button class="btn-stat" onclick="alert('‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥')">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</button>
            <button class="btn-auto" onclick="autoSchedule()">‚ö° ‡∏à‡∏±‡∏î‡∏≠‡∏≠‡πÇ‡∏ï‡πâ</button>
            <button class="btn-clear" onclick="clearSchedule()">üßπ ‡∏•‡πâ‡∏≤‡∏á</button>
            <button class="btn-add" onclick="addNurse()">üë§ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ô</button>
            <button class="btn-export" onclick="exportCSV()">üì• Export</button>
        </div>
    </div>

    <div class="note-section">
        <input type="text" class="note-input" placeholder="üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°...">
    </div>

    <div style="padding: 5px; font-size: 12px; text-align: center; background: #fff;">
        üé® 
        <span style="background:var(--shift-m); padding:0 4px;">‡∏ä=‡πÄ‡∏ä‡πâ‡∏≤</span> 
        <span style="background:var(--shift-a); padding:0 4px;">‡∏ö=‡∏ö‡πà‡∏≤‡∏¢</span> 
        <span style="background:var(--shift-n); padding:0 4px;">‡∏î=‡∏î‡∏∂‡∏Å</span> 
        | ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏ã‡∏•‡∏•‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏ß‡∏£ | ‡πÅ‡∏ñ‡∏ß‡∏ö‡∏ô=OT | ‡πÅ‡∏ñ‡∏ß‡∏•‡πà‡∏≤‡∏á=‡πÄ‡∏ß‡∏£‡∏õ‡∏Å‡∏ï‡∏¥
    </div>

    <div class="table-container">
        <table id="scheduleTable">
            <thead></thead>
            <tbody id="scheduleBody"></tbody>
            <tfoot id="scheduleFoot"></tfoot>
        </table>
    </div>

    <script>
        // --- Configuration ---
        const config = {
            daysInMonth: 31,
            month: 11, year: 2025,
            target: { m: 5, a: 3, n: 2 }
        };
        const shiftTypes = ['', '‡∏ä', '‡∏ö', '‡∏î', 'Va', '‡∏õ‡∏ä', '0'];
        let holidays = new Set([6, 7, 13, 14, 20, 21, 27, 28]);

        let nurses = [
            { id: 1, name: "‡∏ô‡∏≤‡∏á‡∏™‡∏á‡∏ö ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏ò‡∏£‡∏£‡∏°", pos: "‡∏´‡∏ô‡∏ï.", level: 6 },
            { id: 2, name: "‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏©‡∏ì‡∏∏‡∏Å‡∏£‡∏ì‡πå ‡πÇ‡∏≠‡∏ä‡∏≤", pos: "Level 5", level: 5 },
            { id: 3, name: "‡∏ô.‡∏™.‡∏à‡∏≤‡∏£‡∏∏‡∏û‡∏£ ‡∏®‡∏£‡∏µ‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥", pos: "Level 5", level: 5 },
            { id: 4, name: "‡∏ô.‡∏™.‡πÄ‡∏Ç‡∏°‡∏£‡∏∏‡∏à‡∏¥ ‡∏¢‡∏≤‡∏™‡∏π", pos: "Level 5", level: 5 },
            { id: 5, name: "‡∏ô.‡∏™.‡∏õ‡∏≤‡∏à‡∏≤‡∏£‡∏µ‡∏¢‡πå ‡∏ô‡∏¥‡∏û‡∏±‡∏ô‡∏ò‡πå", pos: "Level 5", level: 5 },
            { id: 6, name: "‡∏ô.‡∏™.‡∏™‡∏∏‡∏ô‡∏¥‡∏™‡∏≤ ‡∏™‡∏∏‡∏Ç‡πÄ‡∏≠‡∏¥‡∏ö", pos: "Level 4", level: 4 },
            { id: 7, name: "‡∏ô.‡∏™.‡∏™‡∏∏‡∏†‡∏≤‡∏ß‡∏î‡∏µ ‡∏¢‡∏°‡∏ô‡πâ‡∏≠‡∏¢", pos: "Level 4", level: 4 },
            { id: 8, name: "‡∏ô.‡∏™.‡∏ó‡∏¥‡∏û‡∏õ‡∏†‡∏≤ ‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏ò‡∏µ", pos: "Level 2", level: 2 },
            { id: 9, name: "‡∏ô.‡∏™.‡∏™‡∏∏‡∏ô‡∏±‡∏ô‡∏ó‡∏£‡∏≤ ‡πÄ‡∏Å‡∏ï‡∏∏‡∏û‡∏á‡∏©‡πå", pos: "Level 2", level: 2 },
            { id: 10, name: "‡∏ô.‡∏™.‡∏™‡∏¥‡∏£‡∏¥‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏ö‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡πÄ‡∏™‡∏£‡∏¥‡∏ê", pos: "Level 1", level: 1 }
        ];

        let scheduleData = [];

        function initData() {
            scheduleData = nurses.map(() => [
                new Array(config.daysInMonth).fill(''),
                new Array(config.daysInMonth).fill('')
            ]);
        }

        // --- Rendering ---
        function renderHeader() {
            const thead = document.querySelector('#scheduleTable thead');
            let html = `
                <tr>
                    <th rowspan="2" class="sticky-col col-no">No</th>
                    <th rowspan="2" class="sticky-col col-name">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏Å‡∏∏‡∏•</th>
                    <th rowspan="2" class="sticky-col col-pos">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
            `;
            for (let i = 1; i <= config.daysInMonth; i++) {
                let cls = holidays.has(i) ? 'day-header weekend' : 'day-header';
                html += `<th class="${cls}" onclick="toggleHoliday(${i})">${i}</th>`;
            }
            // Summary Columns Headers
            html += `<th rowspan="2" style="min-width:40px;">‡∏£‡∏ß‡∏°<br>‡∏ö-‡∏î</th>
                     <th rowspan="2" style="min-width:50px;">‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏£<br>‡∏ö-‡∏î</th>
                     <th rowspan="2" style="min-width:40px;">‡∏£‡∏ß‡∏°<br>OT</th>
                     <th rowspan="2" style="min-width:50px;">‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏£<br>OT</th>
                </tr><tr>`;
            
            const daysOfWeek = ['‡∏≠‡∏≤','‡∏à','‡∏≠','‡∏û','‡∏û‡∏§','‡∏®','‡∏™'];
            for (let i = 1; i <= config.daysInMonth; i++) {
                let date = new Date(config.year, config.month, i);
                html += `<th style="font-size:10px; color:#666; background:#f9f9f9;">${daysOfWeek[date.getDay()]}</th>`;
            }
            html += `</tr>`;
            thead.innerHTML = html;
        }

        function renderBody() {
            const tbody = document.getElementById('scheduleBody');
            tbody.innerHTML = '';

            nurses.forEach((nurse, nIdx) => {
                // Row 1: OT
                let trOT = document.createElement('tr');
                trOT.className = 'row-ot';
                trOT.innerHTML = `
                    <td rowspan="2" class="sticky-col col-no">${nurse.id}</td>
                    <td rowspan="2" class="sticky-col col-name">
                        ${nurse.name} <span class="edit-icon" onclick="editName(${nIdx})">‚úèÔ∏è</span>
                    </td>
                    <td rowspan="2" class="sticky-col col-pos">${nurse.pos}</td>
                `;

                // Row 2: Reg
                let trReg = document.createElement('tr');
                trReg.className = 'row-reg';

                for (let d = 0; d < config.daysInMonth; d++) {
                    trOT.innerHTML += createCell(nIdx, 0, d);
                    trReg.innerHTML += createCell(nIdx, 1, d);
                }

                // Stats
                const stats = calculateStats(nIdx);
                trOT.innerHTML += `
                    <td rowspan="2">${stats.bd}</td>
                    <td rowspan="2">${stats.costBD.toLocaleString()}</td>
                    <td rowspan="2">${stats.ot}</td>
                    <td rowspan="2">${stats.costOT.toLocaleString()}</td>
                `;

                tbody.appendChild(trOT);
                tbody.appendChild(trReg);
            });
            renderFooter();
        }

        function createCell(nIdx, rowType, dIdx) {
            let val = scheduleData[nIdx][rowType][dIdx];
            let display = val === '' ? '0' : val;
            let cls = 'shift-cell';
            
            if (val === '‡∏ä') cls += ' s-m';
            else if (val === '‡∏ö') cls += ' s-a';
            else if (val === '‡∏î') cls += ' s-n';
            else if (val === 'Va') cls += ' s-va';
            else cls += ' s-off';

            // Logic: Warn if Night -> Morning
            if (val === '‡∏ä' && dIdx > 0) {
                let prevReg = scheduleData[nIdx][1][dIdx-1];
                let prevOT = scheduleData[nIdx][0][dIdx-1];
                if (prevReg === '‡∏î' || prevOT === '‡∏î') cls += ' error-shift';
            }

            return `<td class="${cls}" onclick="cycleShift(${nIdx}, ${rowType}, ${dIdx})">${display}</td>`;
        }

        function renderFooter() {
            const tfoot = document.getElementById('scheduleFoot');
            let rows = { m: '', a: '', n: '' };
            let labels = { m: '‡πÄ‡∏ä‡πâ‡∏≤', a: '‡∏ö‡πà‡∏≤‡∏¢', n: '‡∏î‡∏∂‡∏Å' };
            let classes = { m: 'ft-m', a: 'ft-a', n: 'ft-n' };

            ['m', 'a', 'n'].forEach(type => {
                rows[type] = `<tr class="${classes[type]}">
                    <td colspan="3" class="sticky-col" style="text-align:right; width:320px;">‡∏£‡∏ß‡∏°${labels[type]}</td>`;
            });

            for (let d = 0; d < config.daysInMonth; d++) {
                let counts = { m: 0, a: 0, n: 0 };
                nurses.forEach((_, nIdx) => {
                    [0, 1].forEach(r => {
                        let s = scheduleData[nIdx][r][d];
                        if (s === '‡∏ä') counts.m++;
                        if (s === '‡∏ö') counts.a++;
                        if (s === '‡∏î') counts.n++;
                    });
                });
                
                rows.m += `<td class="${getColor(counts.m, config.target.m)}">${counts.m}</td>`;
                rows.a += `<td class="${getColor(counts.a, config.target.a)}">${counts.a}</td>`;
                rows.n += `<td class="${getColor(counts.n, config.target.n)}">${counts.n}</td>`;
            }
            
            // Empty cells for summary columns
            const filler = '<td></td><td></td><td></td><td></td>';
            tfoot.innerHTML = rows.m + filler + '</tr>' + rows.a + filler + '</tr>' + rows.n + filler + '</tr>';
        }

        function getColor(val, target) {
            return val < target ? 'count-err' : 'count-ok';
        }

        // --- Logic ---
        function cycleShift(n, r, d) {
            let curr = scheduleData[n][r][d];
            let idx = shiftTypes.indexOf(curr);
            scheduleData[n][r][d] = shiftTypes[(idx + 1) % shiftTypes.length];
            renderBody();
        }

        function calculateStats(nIdx) {
            let bd = 0, ot = 0, costBD = 0, costOT = 0;
            // Row 0 (OT)
            scheduleData[nIdx][0].forEach(s => {
                if(['‡∏ä','‡∏ö','‡∏î'].includes(s)) { ot++; costOT += 800; }
            });
            // Row 1 (Reg)
            scheduleData[nIdx][1].forEach(s => {
                if(['‡∏ö','‡∏î'].includes(s)) { bd++; costBD += 360; }
            });
            return { bd, costBD, ot, costOT };
        }
        
        function toggleHoliday(d) {
            if(holidays.has(d)) holidays.delete(d); else holidays.add(d);
            renderHeader();
        }

        function autoSchedule() {
            if(!confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏ß‡∏£‡πÅ‡∏ö‡∏ö Auto (Mockup) ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡∏à‡∏∞‡∏´‡∏≤‡∏¢")) return;
            initData();
            // Simple Pattern
            nurses.forEach((_, n) => {
                let offset = n*2;
                for(let d=0; d<config.daysInMonth; d++) {
                    let p = (d+offset)%6;
                    if(n===0 && holidays.has(d+1)) continue; // HN ‡∏´‡∏¢‡∏∏‡∏î
                    if(p===0 || p===1) scheduleData[n][1][d] = '‡∏ö';
                    else if(p===2 || p===3) scheduleData[n][1][d] = '‡∏î';
                    else scheduleData[n][1][d] = '‡∏ä'; // Fill Morning
                }
            });
            renderBody();
        }

        function clearSchedule() { initData(); renderBody(); }
        function addNurse() {
            let name = prompt("‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•:");
            if(name) {
                nurses.push({ id: nurses.length+1, name: name, pos: "Level 1" });
                scheduleData.push([new Array(31).fill(''), new Array(31).fill('')]);
                renderBody();
            }
        }
        function editName(i) {
            let n = prompt("‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠:", nurses[i].name);
            if(n) { nurses[i].name = n; renderBody(); }
        }

        // Run
        window.onload = function() {
            initData();
            renderHeader();
            renderBody();
        }
    </script>
</body>
</html>
